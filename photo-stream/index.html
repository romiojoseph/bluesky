<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PhotoStream: Instagram-style Bluesky Image Feed</title>
    <meta name="description"
        content="Browse Bluesky feeds and lists like Instagram. No login, no tracking. View any feed or list you like.">
    <meta property="og:image" content="assets/social-image.png">
    <link rel="icon" type="image/svg+xml" href="assets/favicon.svg">

    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#0866ff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="PhotoStream">
    <link rel="manifest" href="manifest.json">

    <!-- Apple Touch Icons - Note: Apple requires PNGs for home screen icons -->
    <link rel="apple-touch-icon" href="assets/apple-touch-icon.png">
    <link rel="mask-icon" href="assets/favicon.svg" color="#0866ff">

    <meta property="og:title" content="PhotoStream: Instagram-style Bluesky Image Feed">
    <meta property="og:description"
        content="Browse Bluesky feeds and lists like Instagram. No login, no tracking. View any feed or list you like.">
    <meta property="og:site_name" content="PhotoStream: Instagram-style Bluesky Image Feed">
    <meta property="og:image" content="assets/social-image.png">
    <meta property="og:url" content="https://romiojoseph.github.io/bluesky/photo-stream/">
    <meta property="og:type" content="website">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Rancho&display=swap"
        rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="https://unpkg.com/@phosphor-icons/web@2.1.1/src/duotone/style.css" />
    <link rel="stylesheet" href="styles.css">

    <meta name="robots" content="index, follow">
</head>

<body>
    <!-- Loading Screen (no changes) -->
    <div id="loadingScreen">
        <div class="loader"></div>
        <p>Getting the latest posts...</p>
    </div>

    <!-- Theme Toggle (no changes) -->
    <button id="theme-toggle" class="theme-toggle" type="button" title="Switch theme">
        <i class="ph-duotone ph-sun-dim"></i>
    </button>

    <!-- Fixed Header (no changes) -->
    <header id="main-header">
        <div class="logo" id="logo">PhotoStream</div>
        <nav class="predefined-feeds">
            <!-- Buttons moved here -->
            <button type="button" data-url="https://bsky.app/profile/bsky.app/feed/whats-hot"
                title="Discover Feed">Discover</button>
            <button type="button" data-url="https://bsky.app/profile/gabriellanonino.com/feed/aaacm6hg3tlui"
                title="Photography Feed">Photography</button>
            <button type="button" data-url="https://bsky.app/profile/romiojoseph.github.io/lists/3lc34yoopje27"
                title="News Feed">News</button>
            <button type="button" data-url="https://bsky.app/profile/romiojoseph.github.io/lists/3lh6agik2oh2x"
                title="Tech List">Tech</button>
            <button type="button" data-url="https://bsky.app/profile/romiojoseph.github.io/feed/aaaoy5eufdxdo"
                title="Astronomy Feed">Astronomy</button>
            <button type="button" data-url="https://bsky.app/profile/romiojoseph.github.io/lists/3levis2b5yj2e"
                title="Entertainment List">Entertainment</button>

        </nav>
        <button id="configButton" class="header-action-btn" type="button" title="Configure Custom Feed">
            <i class="ph-duotone ph-gear"></i>
        </button>
    </header>


    <!-- Error Message Area (no changes) -->
    <div class="container" id="errorMessageContainer">
        <div id="errorMessage">
        </div>
    </div>


    <!-- Posts Container (no changes) -->
    <div class="container" id="posts-container">
        <!-- Posts will be loaded here -->
    </div>

    <!-- Load More Button Area (no changes) -->
    <div class="container" id="loadMoreContainer">
        <button type="button" id="loadMoreButton">Load more posts</button>
    </div>

    <!-- Footer (no changes) -->
    <footer>
        <h6>
            Footnote
        </h6>
        <p>
            Bluesky offers incredible flexibility. If someone wanted an Instagram-like client tailored to individual
            preferences, it's entirely possible to build one (I'm not quite there yet). This project explores that idea.
            Right now it's just a front end and properly linked to their rerspective posts. With Bluesky now supporting
            video, creating short-form and long-form video feeds (Yes, YouTube like apps!) also seems likely in the
            future. The platform's openness is amazing.
        </p>
        <p>
            For this project, I've added a few feeds and lists, and you'll land on the Discover feed offered by Bluesky
            itself. The condition is that a post will be shown only if it has one or more images. Bring your own Bluesky
            feed or list URL to fetch posts. Your URL will be saved for future visits. If your browser has autofill
            enabled, you can quickly switch between multiple links you've used before. Links, hashtags, and mentions are
            clickable. Click any image to open it in a new tab.
        </p>
        <p>I don't control or take responsibility for the posts shown here. They're from their respective owners. Feel
            free to crosscheck with the original posts. Each one is properly linked to its author and source.
        </p>
        <p>This website runs entirely in your browser using the Bluesky AppView API, with no data sent anywhere. No
            analytics or trackers are used, so you can explore freely. All JavaScript was developed with the help of
            LLMs like Mistral AI, Claude, and Google AI Studio. I built this to make Bluesky accessible to people who
            prefer not to sign up or log in (but I highly recommend creating an account, as Bluesky has the potential to
            become a better platform).
        </p>
        <p>Explore my other Bluesky projects:</p>
        <button alt="EXplore button" title="Explore spotlight feeds of Bluesky" type="button"
            onclick="window.open('https://romiojoseph.github.io/bluesky/', '_blank', 'noopener'); return false;">
            Free Bluesky Tools
        </button>
    </footer>

    <!-- Configuration Modal (no changes) -->
    <div id="configModal">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h5>Enter Bluesky feed or list</h5>
                <p>Bring your own Bluesky feed or list URL to fetch posts. Your URL will be saved for future visits. If
                    your browser has autofill enabled, you can quickly switch between multiple links you've used before.
                </p>
            </div>
            <button id="closeModalButton" title="Close">Ã—</button>

            <div class="custom-feed-input">
                <input type="text" id="bskyUrlInput" placeholder="https://bsky.app/profile/user/feed/id">
            </div>
            <div>
                <button type="button" id="fetchCustomFeedButton">Fetch & Save</button>
            </div>
        </div>
    </div>


    <!-- Load JavaScript files as modules -->
    <script type="module" src="main.js"></script>
    <script>
        // Simple logo click reload
        document.getElementById("logo").addEventListener("click", () => {
            window.scrollTo(0, 0); // Scroll to top
            location.reload();     // Then reload
        });

        // PWA Service Worker Registration
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then(registration => {
                        console.log('ServiceWorker registration successful with scope: ', registration.scope);
                    })
                    .catch(error => {
                        console.log('ServiceWorker registration failed: ', error);
                    });
            });
        } else {
            console.log('Service workers are not supported.');
        }
    </script>

</body>

</html>